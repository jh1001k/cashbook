<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdu.cashbook1.mapper.CashMapper">
	<delete id="deleteCashByDate" parameterType="int">
		DELETE FROM cash
		WHERE cash_no = #{cashNo}
	</delete>
	
	<select id="selectCashKindSum" parameterType="com.gdu.cashbook1.vo.Cash" resultType="int">
		SELECT
			(SELECT IFNULL(SUM(cash_price),'0') 
			FROM cash
			WHERE member_id = #{memberId} 
			AND cash_kind = '수입'
			AND cash_date = #{cashDate}
			)
			-
			(SELECT IFNULL(SUM(cash_price),'0') 
			FROM cash
			WHERE member_id = #{memberId} 
			AND cash_kind = '지출'
			AND cash_date = #{cashDate}
			)
		FROM dual
	</select>

	<insert id="insertCashByDate" parameterType="com.gdu.cashbook1.vo.Cash">
		INSERT INTO cash(
			category_name,
			cash_price,
			cash_place,
			cash_memo
		) VALUES (
			#{categoryName},
			#{cashPrice},
			#{cashPlace},
			#{cashMemo}
		)	
	</insert>

	<select id="selectCashListByDate" parameterType="com.gdu.cashbook1.vo.Cash" resultType="com.gdu.cashbook1.vo.Cash">
		SELECT 
			cash_no cashNo,
			cash_kind cashKind,
			category_name categoryName,
			cash_price cashPrice,
			cash_place cashPlace,
			cash_memo cashMemo
		FROM cash
		WHERE member_id = #{memberId}
		AND cash_date = #{cashDate}
		ORDER BY cash_no ASC
	</select>
</mapper>